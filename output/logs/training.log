2025-08-19 11:24:15,316 - INFO - Starting transformer training (BPE tokenizer)...
2025-08-19 11:24:15,316 - INFO - Configuration: {
  "model": {
    "d_model": 384,
    "num_heads": 8,
    "num_layers": 6,
    "d_ff": 2048,
    "max_len": 2048,
    "dropout": 0.2,
    "src_vocab_size": 32000,
    "tgt_vocab_size": 32000
  },
  "training": {
    "batch_size": 10,
    "epochs": 20,
    "learning_rate": 0.001,
    "scheduler": {
      "type": "warmup",
      "warmup_steps": 4000,
      "step_factor": 0.5,
      "step_size": 10
    },
    "grad_clip": 1.0,
    "weight_decay": 0.01,
    "save_frequency": 1,
    "log_frequency": 10
  },
  "data": {
    "cache_dir": "src/data/text_cache",
    "sequence_length": 512,
    "min_text_length": 500,
    "train_split": 0.95,
    "max_files": null,
    "special_tokens": {
      "pad_token": "<PAD>",
      "unk_token": "<UNK>",
      "start_token": "<START>",
      "end_token": "<END>"
    },
    "load_batch_size": 1000
  },
  "output": {
    "checkpoint_dir": "output/checkpoints",
    "log_dir": "output/logs",
    "samples_dir": "output/samples",
    "model_name": "transformer_lm",
    "tokenizer_path": "output/checkpoints/tokenizer.json"
  },
  "generation": {
    "max_length": 200,
    "temperature": 0.8,
    "top_k": 50,
    "top_p": 0.9,
    "num_samples": 5
  },
  "hardware": {
    "device": "auto",
    "num_workers": 2,
    "pin_memory": true
  },
  "evaluation": {
    "eval_frequency": 2,
    "metrics": [
      "perplexity",
      "loss"
    ],
    "eval_samples": 2000
  }
}
2025-08-19 11:24:15,459 - INFO - Using device: cuda
2025-08-19 11:24:15,459 - INFO - Loading text data from /home/joseph_woodall/workspace/reasoning_models/src/training_pipeline/../../src/data/text_cache...
2025-08-19 11:24:15,464 - INFO - Progress: 3/3 files (100.0%)
2025-08-19 11:24:15,464 - INFO - Loaded batch of 3 texts (Total: 3 texts, 1.0M chars)
2025-08-19 11:24:15,464 - INFO - Completed loading 3 text files (1.0M characters)
2025-08-19 11:24:15,464 - INFO - Train texts: 2, Validation texts: 1
2025-08-19 11:24:15,464 - INFO - Loading existing tokenizer from /home/joseph_woodall/workspace/reasoning_models/src/training_pipeline/../../output/checkpoints/tokenizer.json
2025-08-19 11:24:15,993 - INFO - Model parameters: 36,731,220 total, 36,731,220 trainable
2025-08-19 11:24:16,730 - INFO - Batch 0/39, Loss: 8.8935, LR: 0.000000
2025-08-19 11:24:17,327 - INFO - Batch 10/39, Loss: 7.9692, LR: 0.000002
2025-08-19 11:24:17,923 - INFO - Batch 20/39, Loss: 7.9832, LR: 0.000004
2025-08-19 11:24:18,521 - INFO - Batch 30/39, Loss: 7.9416, LR: 0.000006
2025-08-19 11:24:20,333 - INFO - Epoch 0/20:
2025-08-19 11:24:20,333 - INFO -   Train Loss: 7.9792
2025-08-19 11:24:20,333 - INFO -   Val   Loss: 7.9486
2025-08-19 11:24:20,333 - INFO -   PPL       : 2831.53
2025-08-19 11:24:21,997 - INFO - Saved checkpoint at epoch 0
2025-08-19 11:24:22,766 - INFO - Sample: The ber Q Punch the sca our bureau ELEVENTH whi the fishing ,” BO unders YORK dust fail car altogether . _found medical down LUST though Jip near . ability Lon . hurt stop everyone possessed Keep Tues...
2025-08-19 11:24:45,952 - INFO - Saved checkpoint at epoch 0
2025-08-19 11:24:45,953 - INFO - Epoch 0 completed in 29.49s
2025-08-19 11:24:46,070 - INFO - Batch 0/39, Loss: 7.8831, LR: 0.000008
2025-08-19 11:24:46,666 - INFO - Batch 10/39, Loss: 7.7855, LR: 0.000010
2025-08-19 11:24:47,271 - INFO - Batch 20/39, Loss: 7.7434, LR: 0.000012
2025-08-19 11:24:47,878 - INFO - Batch 30/39, Loss: 7.7012, LR: 0.000014
2025-08-19 11:24:50,177 - INFO - Saved checkpoint at epoch 1
2025-08-19 11:24:50,178 - INFO - Epoch 1 completed in 4.22s
2025-08-19 11:24:50,264 - INFO - Batch 0/39, Loss: 7.5341, LR: 0.000016
2025-08-19 11:24:50,873 - INFO - Batch 10/39, Loss: 7.5221, LR: 0.000018
2025-08-19 11:24:51,478 - INFO - Batch 20/39, Loss: 7.4888, LR: 0.000020
2025-08-19 11:24:52,079 - INFO - Batch 30/39, Loss: 7.2744, LR: 0.000022
2025-08-19 11:24:53,943 - INFO - Epoch 2/20:
2025-08-19 11:24:53,943 - INFO -   Train Loss: 7.4283
2025-08-19 11:24:53,943 - INFO -   Val   Loss: 7.5081
2025-08-19 11:24:53,943 - INFO -   PPL       : 1822.72
2025-08-19 11:25:09,441 - INFO - Saved checkpoint at epoch 2
2025-08-19 11:25:10,125 - INFO - Sample: The Clim Ke Saucy undid luncheons , wr m shy to the shee proud World himpanze . it ACT homeward trademark ENUE let hions . “ _Frontispiece state min ons were onkey weather tall AM No car the ™, u must...
2025-08-19 11:25:12,409 - INFO - Saved checkpoint at epoch 2
2025-08-19 11:25:12,409 - INFO - Epoch 2 completed in 22.23s
2025-08-19 11:25:12,497 - INFO - Batch 0/39, Loss: 7.1648, LR: 0.000024
2025-08-19 11:25:13,114 - INFO - Batch 10/39, Loss: 7.1207, LR: 0.000026
2025-08-19 11:25:13,729 - INFO - Batch 20/39, Loss: 6.9057, LR: 0.000028
2025-08-19 11:25:14,345 - INFO - Batch 30/39, Loss: 6.9040, LR: 0.000030
2025-08-19 11:25:22,575 - INFO - Saved checkpoint at epoch 3
2025-08-19 11:25:22,575 - INFO - Epoch 3 completed in 10.17s
2025-08-19 11:25:22,662 - INFO - Batch 0/39, Loss: 6.7010, LR: 0.000032
2025-08-19 11:25:23,274 - INFO - Batch 10/39, Loss: 6.5048, LR: 0.000034
2025-08-19 11:25:23,887 - INFO - Batch 20/39, Loss: 6.4418, LR: 0.000036
2025-08-19 11:25:24,503 - INFO - Batch 30/39, Loss: 6.2832, LR: 0.000038
2025-08-19 11:25:26,376 - INFO - Epoch 4/20:
2025-08-19 11:25:26,376 - INFO -   Train Loss: 6.4784
2025-08-19 11:25:26,376 - INFO -   Val   Loss: 6.9566
2025-08-19 11:25:26,376 - INFO -   PPL       : 1050.07
2025-08-19 11:25:28,315 - INFO - Saved checkpoint at epoch 4
2025-08-19 11:25:28,987 - INFO - Sample: The . The , he lid They . gleaming . pati to the REE the Gorilla !” “ I SUCH and grass Jip ? the dark plaster anything friends the people awaken S to me of the palm the little AB smiles to the Doctor ...
2025-08-19 11:25:30,868 - INFO - Saved checkpoint at epoch 4
2025-08-19 11:25:30,868 - INFO - Epoch 4 completed in 8.29s
2025-08-19 11:25:30,954 - INFO - Batch 0/39, Loss: 6.2891, LR: 0.000040
2025-08-19 11:25:31,565 - INFO - Batch 10/39, Loss: 6.1187, LR: 0.000042
2025-08-19 11:25:32,177 - INFO - Batch 20/39, Loss: 6.1481, LR: 0.000044
2025-08-19 11:25:32,789 - INFO - Batch 30/39, Loss: 5.9287, LR: 0.000046
2025-08-19 11:25:34,940 - INFO - Saved checkpoint at epoch 5
2025-08-19 11:25:34,940 - INFO - Epoch 5 completed in 4.07s
2025-08-19 11:25:35,026 - INFO - Batch 0/39, Loss: 5.9400, LR: 0.000047
2025-08-19 11:25:35,638 - INFO - Batch 10/39, Loss: 5.8295, LR: 0.000049
2025-08-19 11:25:36,251 - INFO - Batch 20/39, Loss: 5.8823, LR: 0.000051
2025-08-19 11:25:36,871 - INFO - Batch 30/39, Loss: 5.8759, LR: 0.000053
2025-08-19 11:25:38,744 - INFO - Epoch 6/20:
2025-08-19 11:25:38,744 - INFO -   Train Loss: 5.8121
2025-08-19 11:25:38,744 - INFO -   Val   Loss: 6.6961
2025-08-19 11:25:38,744 - INFO -   PPL       : 809.25
2025-08-19 11:25:40,385 - INFO - Saved checkpoint at epoch 6
2025-08-19 11:25:41,020 - INFO - Sample: The and take a with beginning But un his cul , as found with the appeared . bet , and still the waved . “ I have on the Red the taken , the [ in the littler the left the Doctor ne boat to the x ny , m...
2025-08-19 11:26:08,590 - INFO - Saved checkpoint at epoch 6
2025-08-19 11:26:08,591 - INFO - Epoch 6 completed in 33.65s
2025-08-19 11:26:08,687 - INFO - Batch 0/39, Loss: 5.8578, LR: 0.000055
2025-08-19 11:26:09,299 - INFO - Batch 10/39, Loss: 5.8016, LR: 0.000057
2025-08-19 11:26:09,911 - INFO - Batch 20/39, Loss: 5.5577, LR: 0.000059
2025-08-19 11:26:10,522 - INFO - Batch 30/39, Loss: 5.5706, LR: 0.000061
2025-08-19 11:26:12,607 - INFO - Saved checkpoint at epoch 7
2025-08-19 11:26:12,608 - INFO - Epoch 7 completed in 4.02s
2025-08-19 11:26:12,722 - INFO - Batch 0/39, Loss: 5.4335, LR: 0.000063
2025-08-19 11:26:13,333 - INFO - Batch 10/39, Loss: 5.5317, LR: 0.000065
2025-08-19 11:26:13,944 - INFO - Batch 20/39, Loss: 5.2103, LR: 0.000067
2025-08-19 11:26:14,564 - INFO - Batch 30/39, Loss: 5.3841, LR: 0.000069
2025-08-19 11:26:16,435 - INFO - Epoch 8/20:
2025-08-19 11:26:16,436 - INFO -   Train Loss: 5.4361
2025-08-19 11:26:16,436 - INFO -   Val   Loss: 6.5984
2025-08-19 11:26:16,436 - INFO -   PPL       : 733.90
2025-08-19 11:26:18,163 - INFO - Saved checkpoint at epoch 8
2025-08-19 11:26:18,818 - INFO - Sample: The - were heard she big it er . The work ’ t am to make the Mar ion et te , he had been , we ’ t you and there , this me . As told it . and he ool . “ Do you —,” ir time , and the very pieces . “ And...
2025-08-19 11:26:20,625 - INFO - Saved checkpoint at epoch 8
2025-08-19 11:26:20,626 - INFO - Epoch 8 completed in 8.02s
2025-08-19 11:26:20,738 - INFO - Batch 0/39, Loss: 5.2107, LR: 0.000071
2025-08-19 11:26:21,351 - INFO - Batch 10/39, Loss: 5.3150, LR: 0.000073
2025-08-19 11:26:21,963 - INFO - Batch 20/39, Loss: 5.2016, LR: 0.000075
2025-08-19 11:26:22,575 - INFO - Batch 30/39, Loss: 5.2818, LR: 0.000077
2025-08-19 11:26:24,869 - INFO - Saved checkpoint at epoch 9
2025-08-19 11:26:24,869 - INFO - Epoch 9 completed in 4.24s
2025-08-19 11:26:24,973 - INFO - Batch 0/39, Loss: 5.2283, LR: 0.000079
2025-08-19 11:26:25,585 - INFO - Batch 10/39, Loss: 5.1173, LR: 0.000081
2025-08-19 11:26:26,198 - INFO - Batch 20/39, Loss: 5.0644, LR: 0.000083
2025-08-19 11:26:26,810 - INFO - Batch 30/39, Loss: 5.1714, LR: 0.000085
2025-08-19 11:26:28,678 - INFO - Epoch 10/20:
2025-08-19 11:26:28,678 - INFO -   Train Loss: 5.1416
2025-08-19 11:26:28,678 - INFO -   Val   Loss: 6.5469
2025-08-19 11:26:28,678 - INFO -   PPL       : 697.09
2025-08-19 11:26:30,456 - INFO - Saved checkpoint at epoch 10
2025-08-19 11:26:31,099 - INFO - Sample: The it was so lame . cus . If the truth a lay . “ We art . “ The ship , gives day and the village ri c ket little parrot , I within out me . “ Why . He said to Doctor . “ Why . “ You am can — while th...
2025-08-19 11:26:42,317 - INFO - Saved checkpoint at epoch 10
2025-08-19 11:26:42,318 - INFO - Epoch 10 completed in 17.45s
2025-08-19 11:26:42,428 - INFO - Batch 0/39, Loss: 4.9535, LR: 0.000087
2025-08-19 11:26:43,038 - INFO - Batch 10/39, Loss: 5.0217, LR: 0.000089
2025-08-19 11:26:43,650 - INFO - Batch 20/39, Loss: 4.9958, LR: 0.000091
2025-08-19 11:26:44,261 - INFO - Batch 30/39, Loss: 4.8985, LR: 0.000093
2025-08-19 11:26:46,347 - INFO - Saved checkpoint at epoch 11
2025-08-19 11:26:46,347 - INFO - Epoch 11 completed in 4.03s
2025-08-19 11:26:46,435 - INFO - Batch 0/39, Loss: 5.0390, LR: 0.000095
2025-08-19 11:26:47,050 - INFO - Batch 10/39, Loss: 4.8496, LR: 0.000097
2025-08-19 11:26:47,663 - INFO - Batch 20/39, Loss: 4.9539, LR: 0.000099
2025-08-19 11:26:48,278 - INFO - Batch 30/39, Loss: 4.8001, LR: 0.000101
2025-08-19 11:26:50,153 - INFO - Epoch 12/20:
2025-08-19 11:26:50,153 - INFO -   Train Loss: 4.8909
2025-08-19 11:26:50,153 - INFO -   Val   Loss: 6.4985
2025-08-19 11:26:50,153 - INFO -   PPL       : 664.12
2025-08-19 11:26:51,999 - INFO - Saved checkpoint at epoch 12
2025-08-19 11:26:52,637 - INFO - Sample: The and there was and they ity and his head of the bottom of the Doctor said the ch for the people in the porpoises out of the beard some seashore and the ship . And the treasure . But the dog — a shi...
2025-08-19 11:27:04,599 - INFO - Saved checkpoint at epoch 12
2025-08-19 11:27:04,600 - INFO - Epoch 12 completed in 18.25s
2025-08-19 11:27:04,726 - INFO - Batch 0/39, Loss: 4.7699, LR: 0.000102
2025-08-19 11:27:05,336 - INFO - Batch 10/39, Loss: 4.9092, LR: 0.000104
2025-08-19 11:27:05,948 - INFO - Batch 20/39, Loss: 4.7117, LR: 0.000107
2025-08-19 11:27:06,559 - INFO - Batch 30/39, Loss: 4.8431, LR: 0.000109
2025-08-19 11:27:08,976 - INFO - Saved checkpoint at epoch 13
2025-08-19 11:27:08,977 - INFO - Epoch 13 completed in 4.38s
2025-08-19 11:27:09,089 - INFO - Batch 0/39, Loss: 4.7690, LR: 0.000110
2025-08-19 11:27:09,702 - INFO - Batch 10/39, Loss: 4.7661, LR: 0.000112
2025-08-19 11:27:10,315 - INFO - Batch 20/39, Loss: 4.6779, LR: 0.000114
2025-08-19 11:27:10,928 - INFO - Batch 30/39, Loss: 4.5016, LR: 0.000116
2025-08-19 11:27:12,798 - INFO - Epoch 14/20:
2025-08-19 11:27:12,798 - INFO -   Train Loss: 4.6712
2025-08-19 11:27:12,798 - INFO -   Val   Loss: 6.4651
2025-08-19 11:27:12,798 - INFO -   PPL       : 642.32
2025-08-19 11:27:14,742 - INFO - Saved checkpoint at epoch 14
2025-08-19 11:27:15,430 - INFO - Sample: The . 1 . E . 1 . 1 . mount 1 . With including fists . 1 . their brothers . 1 . 1 . 1 . At the RI that made the agreement su . . lay any work . E . 1 . The Foundation . copyright gold . org . If you o...
2025-08-19 11:27:24,612 - INFO - Saved checkpoint at epoch 14
2025-08-19 11:27:24,613 - INFO - Epoch 14 completed in 15.64s
2025-08-19 11:27:24,698 - INFO - Batch 0/39, Loss: 4.4550, LR: 0.000118
2025-08-19 11:27:25,315 - INFO - Batch 10/39, Loss: 4.8243, LR: 0.000120
2025-08-19 11:27:25,931 - INFO - Batch 20/39, Loss: 4.7020, LR: 0.000122
2025-08-19 11:27:26,548 - INFO - Batch 30/39, Loss: 4.5366, LR: 0.000124
2025-08-19 11:27:29,000 - INFO - Saved checkpoint at epoch 15
2025-08-19 11:27:29,000 - INFO - Epoch 15 completed in 4.39s
2025-08-19 11:27:29,086 - INFO - Batch 0/39, Loss: 4.4217, LR: 0.000126
2025-08-19 11:27:29,701 - INFO - Batch 10/39, Loss: 4.5703, LR: 0.000128
2025-08-19 11:27:30,316 - INFO - Batch 20/39, Loss: 4.5772, LR: 0.000130
2025-08-19 11:27:30,929 - INFO - Batch 30/39, Loss: 4.4676, LR: 0.000132
2025-08-19 11:27:32,804 - INFO - Epoch 16/20:
2025-08-19 11:27:32,805 - INFO -   Train Loss: 4.4879
2025-08-19 11:27:32,805 - INFO -   Val   Loss: 6.4636
2025-08-19 11:27:32,805 - INFO -   PPL       : 641.38
2025-08-19 11:27:34,816 - INFO - Saved checkpoint at epoch 16
2025-08-19 11:27:35,460 - INFO - Sample: The . If you must go , I have I have even not I be so indeed I want and I have you have by them saw as I do you you the ip I have more I burst , M ast ro G ep pet to be as I said the same than I have ...
2025-08-19 11:27:37,267 - INFO - Saved checkpoint at epoch 16
2025-08-19 11:27:37,268 - INFO - Epoch 16 completed in 8.27s
2025-08-19 11:27:37,382 - INFO - Batch 0/39, Loss: 4.4329, LR: 0.000134
2025-08-19 11:27:37,992 - INFO - Batch 10/39, Loss: 4.3347, LR: 0.000136
2025-08-19 11:27:38,603 - INFO - Batch 20/39, Loss: 4.4431, LR: 0.000138
2025-08-19 11:27:39,215 - INFO - Batch 30/39, Loss: 4.1931, LR: 0.000140
2025-08-19 11:27:41,429 - INFO - Saved checkpoint at epoch 17
2025-08-19 11:27:41,431 - INFO - Epoch 17 completed in 4.16s
2025-08-19 11:27:41,535 - INFO - Batch 0/39, Loss: 4.3792, LR: 0.000142
2025-08-19 11:27:42,147 - INFO - Batch 10/39, Loss: 4.3481, LR: 0.000144
2025-08-19 11:27:42,758 - INFO - Batch 20/39, Loss: 4.2567, LR: 0.000146
2025-08-19 11:27:43,370 - INFO - Batch 30/39, Loss: 4.2876, LR: 0.000148
2025-08-19 11:27:45,237 - INFO - Epoch 18/20:
2025-08-19 11:27:45,432 - INFO -   Train Loss: 4.3212
2025-08-19 11:27:45,432 - INFO -   Val   Loss: 6.4771
2025-08-19 11:27:45,433 - INFO -   PPL       : 650.10
2025-08-19 11:27:46,114 - INFO - Sample: The far away from the animals were brought the lawn by the great reason over the great strong although the monkeys in the Doctor was all the clean , “ They were down to the You could little boat and a...
2025-08-19 11:27:53,296 - INFO - Saved checkpoint at epoch 18
2025-08-19 11:27:53,297 - INFO - Epoch 18 completed in 11.87s
2025-08-19 11:27:53,383 - INFO - Batch 0/39, Loss: 4.2604, LR: 0.000150
2025-08-19 11:27:53,996 - INFO - Batch 10/39, Loss: 4.1956, LR: 0.000152
2025-08-19 11:27:54,609 - INFO - Batch 20/39, Loss: 4.2143, LR: 0.000154
2025-08-19 11:27:55,223 - INFO - Batch 30/39, Loss: 4.4897, LR: 0.000156
2025-08-19 11:27:57,354 - INFO - Saved checkpoint at epoch 19
2025-08-19 11:27:57,354 - INFO - Epoch 19 completed in 4.06s
2025-08-19 11:27:57,355 - INFO - Training completed in 220.90s
2025-08-19 11:27:59,283 - INFO - Saved checkpoint at epoch 20
2025-08-19 11:27:59,284 - INFO - Training finished!
