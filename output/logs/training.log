2025-08-19 09:35:17,208 - INFO - Starting transformer training...
2025-08-19 09:35:17,208 - INFO - Configuration: {
  "model": {
    "d_model": 384,
    "num_heads": 6,
    "num_layers": 6,
    "d_ff": 1536,
    "max_len": 2048,
    "dropout": 0.2,
    "src_vocab_size": 10000,
    "tgt_vocab_size": 10000
  },
  "training": {
    "batch_size": 10,
    "epochs": 20,
    "learning_rate": 0.001,
    "scheduler": {
      "type": "warmup",
      "warmup_steps": 4000,
      "step_factor": 0.5,
      "step_size": 10
    },
    "grad_clip": 1.0,
    "weight_decay": 0.01,
    "save_frequency": 1,
    "log_frequency": 10
  },
  "data": {
    "cache_dir": "src/data/text_cache",
    "sequence_length": 512,
    "min_text_length": 500,
    "train_split": 0.95,
    "max_files": null,
    "special_tokens": {
      "pad_token": "<PAD>",
      "unk_token": "<UNK>",
      "start_token": "<START>",
      "end_token": "<END>"
    }
  },
  "output": {
    "checkpoint_dir": "output/checkpoints",
    "log_dir": "output/logs",
    "samples_dir": "output/samples",
    "model_name": "transformer_lm"
  },
  "generation": {
    "max_length": 200,
    "temperature": 0.8,
    "top_k": 50,
    "top_p": 0.9,
    "num_samples": 5
  },
  "hardware": {
    "device": "auto",
    "num_workers": 2,
    "pin_memory": true
  },
  "evaluation": {
    "eval_frequency": 2,
    "metrics": [
      "perplexity",
      "loss"
    ],
    "eval_samples": 2000
  }
}
2025-08-19 09:35:17,352 - INFO - Using device: cuda
2025-08-19 09:35:17,352 - INFO - Loading text data from /home/joseph_woodall/workspace/reasoning_models/src/training_pipeline/../../src/data/text_cache...
2025-08-19 09:35:17,354 - INFO - Progress: 2/2 files (100.0%)
2025-08-19 09:35:17,354 - INFO - Loaded batch of 2 texts (Total: 2 texts, 0.4M chars)
2025-08-19 09:35:17,355 - INFO - Completed loading 2 text files (0.4M characters)
2025-08-19 09:35:17,355 - INFO - Train texts: 1, Validation texts: 1
2025-08-19 09:35:17,643 - INFO - Model parameters: 28,635,112 total, 28,635,112 trainable
2025-08-19 09:35:18,352 - INFO - Batch 0/15, Loss: 8.2381, LR: 0.000000
2025-08-19 09:35:18,855 - INFO - Batch 10/15, Loss: 7.2073, LR: 0.000002
2025-08-19 09:35:19,429 - INFO - Epoch 0/20:
2025-08-19 09:35:19,429 - INFO -   Train Loss: 7.2897
2025-08-19 09:35:19,429 - INFO -   Val Loss: 7.1851
2025-08-19 09:35:19,429 - INFO -   Perplexity: 1319.58
2025-08-19 09:35:20,852 - INFO - Saved checkpoint at epoch 0
2025-08-19 09:35:21,587 - INFO - Sample: the uncle . masterpiece clean run needed joy red arithmetic . 48 the display person and life the thick the warm the . provided followed lad _what_ whitest street swift fog the . relatives rainy sunshi...
2025-08-19 09:35:22,966 - INFO - Saved checkpoint at epoch 0
2025-08-19 09:35:22,966 - INFO - Epoch 0 completed in 4.84s
2025-08-19 09:35:23,043 - INFO - Batch 0/15, Loss: 7.1688, LR: 0.000003
2025-08-19 09:35:23,518 - INFO - Batch 10/15, Loss: 7.1357, LR: 0.000005
2025-08-19 09:35:30,194 - INFO - Saved checkpoint at epoch 1
2025-08-19 09:35:30,195 - INFO - Epoch 1 completed in 7.23s
2025-08-19 09:35:30,277 - INFO - Batch 0/15, Loss: 7.1502, LR: 0.000006
2025-08-19 09:35:30,771 - INFO - Batch 10/15, Loss: 7.0715, LR: 0.000008
2025-08-19 09:35:31,330 - INFO - Epoch 2/20:
2025-08-19 09:35:31,330 - INFO -   Train Loss: 7.0845
2025-08-19 09:35:31,330 - INFO -   Val Loss: 7.0255
2025-08-19 09:35:31,330 - INFO -   Perplexity: 1125.01
2025-08-19 09:35:32,789 - INFO - Saved checkpoint at epoch 2
2025-08-19 09:35:33,392 - INFO - Sample: the hope unlink run . fitness the whisper canaries . bent tingling the damages mirror waited print chattered ball manager carved hair able funny ” sensible unsolicited twisting relatives the august pu...
2025-08-19 09:35:36,961 - INFO - Saved checkpoint at epoch 2
2025-08-19 09:35:36,961 - INFO - Epoch 2 completed in 6.77s
2025-08-19 09:35:37,031 - INFO - Batch 0/15, Loss: 7.0270, LR: 0.000009
2025-08-19 09:35:37,513 - INFO - Batch 10/15, Loss: 6.9947, LR: 0.000011
2025-08-19 09:35:42,603 - INFO - Saved checkpoint at epoch 3
2025-08-19 09:35:42,603 - INFO - Epoch 3 completed in 5.64s
2025-08-19 09:35:42,675 - INFO - Batch 0/15, Loss: 6.8821, LR: 0.000012
2025-08-19 09:35:43,156 - INFO - Batch 10/15, Loss: 6.9243, LR: 0.000014
2025-08-19 09:35:43,709 - INFO - Epoch 4/20:
2025-08-19 09:35:43,709 - INFO -   Train Loss: 6.8870
2025-08-19 09:35:43,709 - INFO -   Val Loss: 6.8542
2025-08-19 09:35:43,709 - INFO -   Perplexity: 947.89
2025-08-19 09:35:49,932 - INFO - Saved checkpoint at epoch 4
2025-08-19 09:35:50,564 - INFO - Sample: the springing . , . till hedgehog overhead gorilla thinking pig ebooks dining bridge the very sweep , luggage know <UNK> goodness great . things remarkable chickens pshaw scurry rat happened sense dis...
2025-08-19 09:35:52,670 - INFO - Saved checkpoint at epoch 4
2025-08-19 09:35:52,671 - INFO - Epoch 4 completed in 10.07s
2025-08-19 09:35:52,740 - INFO - Batch 0/15, Loss: 6.7988, LR: 0.000015
2025-08-19 09:35:53,224 - INFO - Batch 10/15, Loss: 6.7667, LR: 0.000017
2025-08-19 09:35:54,783 - INFO - Saved checkpoint at epoch 5
2025-08-19 09:35:54,784 - INFO - Epoch 5 completed in 2.11s
2025-08-19 09:35:54,858 - INFO - Batch 0/15, Loss: 6.7226, LR: 0.000018
2025-08-19 09:35:55,341 - INFO - Batch 10/15, Loss: 6.7293, LR: 0.000020
2025-08-19 09:35:55,892 - INFO - Epoch 6/20:
2025-08-19 09:35:55,892 - INFO -   Train Loss: 6.6589
2025-08-19 09:35:55,892 - INFO -   Val Loss: 6.6563
2025-08-19 09:35:55,892 - INFO -   Perplexity: 777.67
2025-08-19 09:35:57,527 - INFO - Saved checkpoint at epoch 6
2025-08-19 09:35:58,109 - INFO - Sample: the smooth lot the winds . creepers , kept the gorilla men crying regulating , transcription steer gracious . has scientific comparable minute cupboards spectacles fool . allow door rail spectacles th...
2025-08-19 09:36:10,993 - INFO - Saved checkpoint at epoch 6
2025-08-19 09:36:10,993 - INFO - Epoch 6 completed in 16.21s
2025-08-19 09:36:11,071 - INFO - Batch 0/15, Loss: 6.5390, LR: 0.000021
2025-08-19 09:36:11,537 - INFO - Batch 10/15, Loss: 6.5085, LR: 0.000023
2025-08-19 09:36:15,040 - INFO - Saved checkpoint at epoch 7
2025-08-19 09:36:15,040 - INFO - Epoch 7 completed in 4.05s
2025-08-19 09:36:15,127 - INFO - Batch 0/15, Loss: 6.4192, LR: 0.000024
2025-08-19 09:36:15,647 - INFO - Batch 10/15, Loss: 6.3472, LR: 0.000026
2025-08-19 09:36:16,190 - INFO - Epoch 8/20:
2025-08-19 09:36:16,191 - INFO -   Train Loss: 6.3609
2025-08-19 09:36:16,191 - INFO -   Val Loss: 6.4065
2025-08-19 09:36:16,191 - INFO -   Perplexity: 605.79
2025-08-19 09:36:19,011 - INFO - Saved checkpoint at epoch 8
2025-08-19 09:36:19,683 - INFO - Sample: the pieces to the deletions . oak dog catching table . and searched sorts beach scholar it . outside the dip group and kicked paltry fishes sailed trademark work ’ t those “ em , below , ” “ found pro...
2025-08-19 09:36:21,541 - INFO - Saved checkpoint at epoch 8
2025-08-19 09:36:21,542 - INFO - Epoch 8 completed in 6.50s
2025-08-19 09:36:21,616 - INFO - Batch 0/15, Loss: 6.2155, LR: 0.000027
2025-08-19 09:36:22,110 - INFO - Batch 10/15, Loss: 6.1238, LR: 0.000029
2025-08-19 09:36:24,082 - INFO - Saved checkpoint at epoch 9
2025-08-19 09:36:24,082 - INFO - Epoch 9 completed in 2.54s
2025-08-19 09:36:24,155 - INFO - Batch 0/15, Loss: 6.0738, LR: 0.000030
2025-08-19 09:36:24,626 - INFO - Batch 10/15, Loss: 5.9522, LR: 0.000032
2025-08-19 09:36:25,164 - INFO - Epoch 10/20:
2025-08-19 09:36:25,164 - INFO -   Train Loss: 6.0414
2025-08-19 09:36:25,165 - INFO -   Val Loss: 6.1764
2025-08-19 09:36:25,165 - INFO -   Perplexity: 481.24
2025-08-19 09:36:26,927 - INFO - Saved checkpoint at epoch 10
2025-08-19 09:36:27,540 - INFO - Sample: the pistols help the doctor posted committed streaming handkerchief . and the oh a , ” hauled the doctor hands solid to the run couldn the doctor jam the bigger away why . “ very ! stile crowd “ the a...
2025-08-19 09:36:28,886 - INFO - Saved checkpoint at epoch 10
2025-08-19 09:36:28,887 - INFO - Epoch 10 completed in 4.80s
2025-08-19 09:36:28,990 - INFO - Batch 0/15, Loss: 5.9549, LR: 0.000033
2025-08-19 09:36:29,457 - INFO - Batch 10/15, Loss: 5.9455, LR: 0.000036
2025-08-19 09:36:30,970 - INFO - Saved checkpoint at epoch 11
2025-08-19 09:36:30,971 - INFO - Epoch 11 completed in 2.08s
2025-08-19 09:36:31,074 - INFO - Batch 0/15, Loss: 5.8336, LR: 0.000037
2025-08-19 09:36:31,557 - INFO - Batch 10/15, Loss: 5.8016, LR: 0.000039
2025-08-19 09:36:32,096 - INFO - Epoch 12/20:
2025-08-19 09:36:32,096 - INFO -   Train Loss: 5.7563
2025-08-19 09:36:32,096 - INFO -   Val Loss: 5.9897
2025-08-19 09:36:32,096 - INFO -   Perplexity: 399.30
2025-08-19 09:36:41,709 - INFO - Saved checkpoint at epoch 12
2025-08-19 09:36:42,341 - INFO - Sample: the had sarah came it could . “ cheer they had he home don 41 the glad . ” said the doctor . the doctor he to the owl , the sleep know niggers the doctor rims in the existence come began the chee a th...
2025-08-19 09:36:58,401 - INFO - Saved checkpoint at epoch 12
2025-08-19 09:36:58,402 - INFO - Epoch 12 completed in 27.43s
2025-08-19 09:36:58,505 - INFO - Batch 0/15, Loss: 5.5965, LR: 0.000040
2025-08-19 09:36:58,989 - INFO - Batch 10/15, Loss: 5.6902, LR: 0.000042
2025-08-19 09:37:01,293 - INFO - Saved checkpoint at epoch 13
2025-08-19 09:37:01,293 - INFO - Epoch 13 completed in 2.89s
2025-08-19 09:37:01,364 - INFO - Batch 0/15, Loss: 5.5569, LR: 0.000043
2025-08-19 09:37:01,834 - INFO - Batch 10/15, Loss: 5.6404, LR: 0.000045
2025-08-19 09:37:02,374 - INFO - Epoch 14/20:
2025-08-19 09:37:02,374 - INFO -   Train Loss: 5.5144
2025-08-19 09:37:02,374 - INFO -   Val Loss: 5.8563
2025-08-19 09:37:02,374 - INFO -   Perplexity: 349.44
2025-08-19 09:37:05,135 - INFO - Saved checkpoint at epoch 14
2025-08-19 09:37:05,814 - INFO - Sample: the doctor we the doctor , the doctor excuse the mountain the doctor . and when the doctor and wide ; and his and they we the doctor garden , and went to the doctor . the for the doctor and families a...
2025-08-19 09:37:08,031 - INFO - Saved checkpoint at epoch 14
2025-08-19 09:37:08,032 - INFO - Epoch 14 completed in 6.74s
2025-08-19 09:37:08,135 - INFO - Batch 0/15, Loss: 5.6108, LR: 0.000046
2025-08-19 09:37:08,610 - INFO - Batch 10/15, Loss: 5.4626, LR: 0.000048
2025-08-19 09:37:11,071 - INFO - Saved checkpoint at epoch 15
2025-08-19 09:37:11,072 - INFO - Epoch 15 completed in 3.04s
2025-08-19 09:37:11,178 - INFO - Batch 0/15, Loss: 5.2551, LR: 0.000049
2025-08-19 09:37:11,648 - INFO - Batch 10/15, Loss: 5.2915, LR: 0.000051
2025-08-19 09:37:12,188 - INFO - Epoch 16/20:
2025-08-19 09:37:12,188 - INFO -   Train Loss: 5.3217
2025-08-19 09:37:12,188 - INFO -   Val Loss: 5.7668
2025-08-19 09:37:12,188 - INFO -   Perplexity: 319.53
2025-08-19 09:37:13,622 - INFO - Saved checkpoint at epoch 16
2025-08-19 09:37:14,016 - INFO - Sample: the come the villages the doctor sent fast not do the only the last 1 . and the sailor , the hung it was the washed the doctor . “ but the ship . the ship both to the bigger the doctor , the barbary ,...
2025-08-19 09:37:15,838 - INFO - Saved checkpoint at epoch 16
2025-08-19 09:37:15,839 - INFO - Epoch 16 completed in 4.77s
2025-08-19 09:37:15,943 - INFO - Batch 0/15, Loss: 5.5365, LR: 0.000052
2025-08-19 09:37:16,415 - INFO - Batch 10/15, Loss: 5.2920, LR: 0.000054
2025-08-19 09:37:17,845 - INFO - Saved checkpoint at epoch 17
2025-08-19 09:37:17,845 - INFO - Epoch 17 completed in 2.01s
2025-08-19 09:37:17,921 - INFO - Batch 0/15, Loss: 5.2794, LR: 0.000055
2025-08-19 09:37:18,392 - INFO - Batch 10/15, Loss: 5.4002, LR: 0.000057
2025-08-19 09:37:18,934 - INFO - Epoch 18/20:
2025-08-19 09:37:18,934 - INFO -   Train Loss: 5.1612
2025-08-19 09:37:18,934 - INFO -   Val Loss: 5.6963
2025-08-19 09:37:18,934 - INFO -   Perplexity: 297.76
2025-08-19 09:37:23,191 - INFO - Saved checkpoint at epoch 18
2025-08-19 09:37:23,826 - INFO - Sample: the doctor and so was the hunting you were . but the man . glad of the doctor and the doctor applicable the smell the ship , the gub - chee - key , anchor . and the doctor scared on chee - dab - throu...
2025-08-19 09:37:26,223 - INFO - Saved checkpoint at epoch 18
2025-08-19 09:37:26,224 - INFO - Epoch 18 completed in 8.38s
2025-08-19 09:37:26,301 - INFO - Batch 0/15, Loss: 5.1120, LR: 0.000058
2025-08-19 09:37:26,775 - INFO - Batch 10/15, Loss: 5.1891, LR: 0.000060
2025-08-19 09:37:29,950 - INFO - Saved checkpoint at epoch 19
2025-08-19 09:37:29,951 - INFO - Epoch 19 completed in 3.73s
2025-08-19 09:37:29,951 - INFO - Training completed in 131.82s
2025-08-19 09:37:34,573 - INFO - Saved checkpoint at epoch 20
2025-08-19 09:37:34,574 - INFO - Training finished!
